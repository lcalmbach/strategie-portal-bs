{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block title %}Gleichstellung BS: Ziele und Massnahmen{% endblock title %}
{% block content %}

<div class="container">
    <h1>Person bearbeiten</h1>
    <form method="post">
        {% csrf_token %}
        {{ form|crispy }}
        
        <button type="submit" class="btn btn-primary">Speichern</button>
        <button type="button" class="btn btn-secondary" onclick="window.history.back()">Zurück</button>
        {% if form.instance.pk %}
            <button type="button" class="btn btn-danger" onclick="confirmDelete({{ form.instance.pk }})">Löschen</button>
        {% endif %}
        <button type="button" class="btn btn-success" onclick="window.location.href='{% url "organisation_create" %}'">Neu</button>
    </form>
</div>

<script type="text/javascript">
    function confirmDelete(personid) {
        if (confirm('Bist du sicher, dass du diese Person löschen möchtest?')) {
            var form = document.createElement('form');
            form.method = 'POST';
            form.action = `/person/${personid}/delete/`;  // Construct the URL dynamically using template literals
            var csrfToken = document.createElement('input');
            csrfToken.type = 'hidden';
            csrfToken.name = 'csrfmiddlewaretoken';
            csrfToken.value = '{{ csrf_token }}';
            form.appendChild(csrfToken);
            document.body.appendChild(form);
            form.submit();
        }
    }
</script>
{% endblock %}
